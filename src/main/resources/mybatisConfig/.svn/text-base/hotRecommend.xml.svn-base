<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 热门推荐 -->
<mapper namespace="hotrecommed">

  <resultMap id="getHotRecommedMap" type="_Hot_Recommend">
    <id property="id" column="id"/>
	<result property="dealStatus" column="deal_status"/>
	<result property="operateType" column="operate_type"/>
	<result property="target" column="target"/>
	<result property="app1" column="app1"/>
	<result property="app2" column="app2"/>
	<result property="app3" column="app3"/>
	<result property="app4" column="app4"/>
	<result property="app5" column="app5"/>
	<result property="app6" column="app6"/>
	<result property="app7" column="app7"/>
	<result property="app8" column="app8"/>
	<result property="app9" column="app9"/>
	<result property="app10" column="app10"/>
	<result property="branchId" column="branch_id"/>
	<result property="channelId" column="channel_id"/>
	<result property="operatorId" column="operator_id"/>
	<result property="reviewerId" column="reviewer_id"/>
	<result property="submitDate" column="submit_date"/>
	<result property="reviewDate" column="review_date"/>
  </resultMap>
  
  <sql id="resultColumn">
		id,deal_status,operate_type,target,app1,app2,
		app3,app4,app5,app6,app7,app8,app9,app10,branch_id,channel_id,operator_id,reviewer_id,
		submit_date,review_date
	</sql>
  
  <update id="updateHr">
		update llbtmp_hot_recommend set id=#{id}
		 <if test="dealStatus != null and dealStatus != '' ">, deal_status=#{dealStatus,jdbcType=VARCHAR}</if>
		<if test="operateType != null and operateType != ''"> ,operate_type=#{operateType,jdbcType=VARCHAR}</if>
		<if test="target != null and target != '' "> ,target=#{target,jdbcType=VARCHAR}</if>
		<if test="app1 != null and app1 != '' "> ,app1=#{app1,jdbcType=VARCHAR}</if>
		<if test="app2 != null and app2 != '' "> ,app2=#{app2,jdbcType=VARCHAR}</if>
		<if test="app3 != null and app3 != '' "> ,app3=#{app3,jdbcType=VARCHAR}</if>
		<if test="app4 != null and app4 != '' "> ,app4=#{app4,jdbcType=VARCHAR}</if>
		<if test="app5 != null and app5 != '' "> ,app5=#{app5,jdbcType=VARCHAR}</if>
		<if test="app6 != null and app6 != '' "> ,app6=#{app6,jdbcType=VARCHAR}</if>
		<if test="app7 != null and app7 != '' "> ,app7=#{app7,jdbcType=VARCHAR}</if>
		<if test="app8 != null and app8 != '' "> ,app8=#{app8,jdbcType=VARCHAR}</if>
		<if test="app9 != null and app9 != '' "> ,app9=#{app9,jdbcType=VARCHAR}</if>
		<if test="app10 != null and app10 != '' "> ,app10=#{app10,jdbcType=VARCHAR}</if>
		<if test="branchId != null and branchId != '' "> ,branch_id=#{branchId,jdbcType=NUMERIC}</if>
		<if test="channelId != null and channelId != '' "> ,channel_id=#{channelId,jdbcType=NUMERIC}</if>
		<if test="operatorId != null and operatorId != '' "> ,operator_id=#{operatorId,jdbcType=NUMERIC}</if>
		<if test="reviewerId != null and reviewerId != '' "> ,reviewer_id=#{reviewerId,jdbcType=NUMERIC}</if>
		<if test="submitDate != null and submitDate != '' "> ,submit_date=#{submitDate,jdbcType=DATE}</if>
		<if test="reviewDate != null and reviewDate != '' "> ,reviewDate=#{version,jdbcType=DATE}</if>
		where id = #{id}
	</update>
  
  <insert id="saveHR" parameterType="_Hot_Recommend">
  	INSERT INTO llbtmp_hot_recommend (
		<include refid="resultColumn" />
		)
		values (
		#{id},
		#{dealStatus,jdbcType=VARCHAR},
		#{operateType,jdbcType=VARCHAR},
		#{target,jdbcType=VARCHAR},
		#{app1,jdbcType=VARCHAR},
		#{app2,jdbcType=VARCHAR},
		#{app3,jdbcType=VARCHAR},
		#{app4,jdbcType=VARCHAR},
		#{app5,jdbcType=VARCHAR},
		#{app6,jdbcType=VARCHAR},
		#{app7,jdbcType=VARCHAR},
		#{app8,jdbcType=VARCHAR},
		#{app9,jdbcType=VARCHAR},
		#{app10,jdbcType=VARCHAR},
		#{branchId,jdbcType=NUMERIC},
		#{channelId,jdbcType=NUMERIC},
		#{operatorId,jdbcType=NUMERIC},
		#{reviewerId,jdbcType=NUMERIC},
		to_date(#{submitDate,jdbcType=DATE},'yyyy-mm-dd hh24:mi:ss'),
		to_date(#{reviewDate,jdbcType=DATE},'yyyy-mm-dd hh24:mi:ss')																																
		)	
  </insert>
  
  <select id="selectOneReview" resultMap="getHotRecommedMap">
  		select * from llbtmp_hot_recommend where DEAL_STATUS = 0
  </select>

	<delete id="deleteHr" parameterType="long">
		delete from llbtmp_hot_recommend where id = #{id}
	</delete>
	
	<select id="selectOneDeal" resultMap="getHotRecommedMap">
		select * from llbtmp_hot_recommend where DEAL_STATUS = 1
	</select>
	
	<select id="selectChannelId" parameterType="long" resultMap="getHotRecommedMap">
		select * from llbtmp_hot_recommend where id = #{id}
	</select>
	
	<select id="selectHr" resultMap="getHotRecommedMap" parameterType="long">
		select * from llbtmp_hot_recommend where DEAL_STATUS = 1 and channel_id = #{cId}
	</select>
	
	<select id="getReviewApp" resultMap="getHotRecommedMap" parameterType="long">
		select * from llbtmp_hot_recommend where DEAL_STATUS = 0 and channel_id = #{cId}
	</select>
	
	<select id="Judge" resultMap="getHotRecommedMap">
		select * from llbtmp_hot_recommend where DEAL_STATUS = 1 and channel_id = 1
	</select>
	
	<select id="JudgeIphone" resultMap="getHotRecommedMap" parameterType="long">
		select * from llbtmp_hot_recommend where DEAL_STATUS = 1 and channel_id = #{id}
	</select>
</mapper>